<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Fattura {{invoiceNumber}}</title>

<link rel="stylesheet" href="https://use.typekit.net/ekm2csm.css">

<style>
@page{
  size:A4;
  margin:10mm;
}

:root{
  --text:#000;
  --line:#000;
  --font:"Elza",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif;
  --fs:12px;
  --lh:1.35;
}

/* GLOBAL */
*{
  box-sizing:border-box;
  font-size:var(--fs);
  font-weight:500;
  -webkit-print-color-adjust: exact !important;
  print-color-adjust: exact !important;
  color-adjust: exact !important;
}

html,body{height:100%;}

body{
  margin:0;
  background:#f2f2f2;
  color:var(--text);
  font-family:var(--font);
  line-height:var(--lh);
}

/* A4 PAGE */
.page{
  width:210mm;
  min-height:297mm;
  margin:16px auto;
  padding:10mm;
  background:#fff;
  border:1px solid #d0d0d0;

  /* MAGIC: footer sempre in basso */
  display:flex;
  flex-direction:column;
}

/* CONTENUTO SCROLLABILE */
.content{
  flex:1;
}

/* HEADER */
.top{
  display:grid;
  grid-template-columns:1fr 1fr;
  column-gap:18mm;
}

.block{display:block;margin:0;}

.meta{
  justify-self:end;
  max-width:78mm;
  width:100%;
}

.meta-row{
  display:grid;
  grid-template-columns:1fr auto;
  column-gap:10mm;
}

.meta-value{
  text-align:right;
  white-space:nowrap;
}

/* SECTIONS */
.section{margin-top:18mm;}
.section-title{margin:0 0 2mm 0;}

.client-lines{display:block;margin:0;}
.object-lines{margin:0;}

/* TABLE */
.services{margin-top:10mm;}

table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
}

col:nth-child(1){width:58%;}
col:nth-child(2){width:14%;}
col:nth-child(3){width:14%;}
col:nth-child(4){width:14%;}

thead th{
  border-bottom:1px solid var(--line);
  padding-bottom:1mm;
  font-size:9px;
  text-align:left;
}

thead th:nth-child(2),
thead th:nth-child(3){text-align:center;}

thead th:nth-child(4){text-align:right;}

tbody td{
  border-bottom:1px solid var(--line);
  padding:2mm 0;
}

tbody td:nth-child(2),
tbody td:nth-child(3){
  text-align:center;
  white-space:nowrap;
}

tbody td:nth-child(4){
  text-align:right;
  white-space:nowrap;
}

/* TOTAL */
.total-row{
  display:grid;
  grid-template-columns:1fr auto;
  margin-top:10mm;
}

.total-value{text-align:right;}

/* FOOTER BLOCCATO IN BASSO */
.footer{
  margin-top:20mm;
}

/* PAYMENT GRID */
.kv{
  display:grid;
  grid-template-columns:38mm 1fr;
  column-gap:6mm;
  margin-bottom:12mm;
}

.v{
    white-space:pre-line;
}

.notes{
    margin:0;
    width: 50%;
    font-size: 9px;
}

/* PRINT */
@media print{
  body{background:#fff;}
  .page{
    margin:0;
    border:0;
    padding:0;
    width:auto;
    min-height:auto;
  }
}
</style>
</head>

<body>

<main class="page">

  <!-- CONTENUTO -->
  <div class="content">

    <header class="top">
      <div>
        <span class="block">MISMO&reg;STUDIO</span>
        <span class="block">di Stefano Costato e Davide Marangoni</span>
        <span class="block">P.IVA IT04904900232 / IT05052740239</span>
        <span class="block">hi@mismo.studio</span>
        <span class="block">(+39) 375 620 9885</span>
        <span class="block">Via Madonna 14 - 37026</span>
        <span class="block">Pescantina / Verona - IT</span>
      </div>

      <div class="meta">
        <div class="meta-row">
          <div>Fattura numero</div>
          <div class="meta-value">{{invoiceNumber}}</div>
        </div>
        <div class="meta-row">
          <div>Data</div>
          <div class="meta-value">{{invoiceDate}}</div>
        </div>
        <div class="meta-row">
          <div>Scadenza</div>
          <div class="meta-value">{{#if paymentDaysImmediate}}Immediato{{else}}{{paymentDays}} giorni{{/if}}</div>
        </div>
      </div>
    </header>

    <section class="section">
      <h2 class="section-title">Cliente</h2>
      <span class="client-lines">{{clientName}}</span>
      {{#if clientPIva}}
      <span class="client-lines">P.IVA {{clientPIva}}</span>
      {{/if}}
      {{#if clientCF}}
      <span class="client-lines">C.F. {{clientCF}}</span>
      {{/if}}
      {{#if clientAddress}}
      <span class="client-lines">{{clientAddress}}</span>
      {{/if}}
    </section>

    <section class="section">
      <h2 class="section-title">Oggetto</h2>
      <p class="object-lines">{{subject}}</p>
    </section>

    <section class="services">
      <table>
        <colgroup><col><col><col><col></colgroup>
        <thead>
          <tr>
            <th>Servizio</th>
            <th>Quantit&agrave;</th>
            <th>IVA</th>
            <th>Prezzo cad.</th>
          </tr>
        </thead>
        <tbody>
          {{#each services}}
          <tr>
            <td>{{this.description}}</td>
            <td>{{this.quantity}}</td>
            <td>{{../vatPercentage}}%</td>
            <td>{{this.unitPrice}} EUR</td>
          </tr>
          {{/each}}
        </tbody>
      </table>

      <div class="total-row">
        <div>Totale</div>
        <div class="total-value">{{total}} EUR</div>
      </div>
    </section>

  </div>

  <!-- FOOTER FISSO -->
  <footer class="footer">

    <h2 class="section-title">Informazioni per il pagamento</h2>
    <div class="kv">
      <div>Scadenze</div><div class="v">{{#if paymentDaysImmediate}}Immediato{{else}}{{dueDate}}{{/if}}: {{total}} EUR</div>
      <div>Beneficiario</div><div class="v">{{paymentBeneficiary}}</div>
      <div>IBAN</div><div class="v">{{paymentIban}}</div>
      <div>Banca</div><div class="v">{{paymentBank}}</div>
      {{#if paymentBic}}
      <div>BIC</div><div class="v">{{paymentBic}}</div>
      {{/if}}
      {{#if paymentSdi}}
      <div>SDI</div><div class="v">{{paymentSdi}}</div>
      {{/if}}
    </div>

    <h2 class="section-title">Annotazioni</h2>
    <p class="notes">
{{#if fiscalNotes}}
{{fiscalNotes}}
{{else}}
{{#if isVatZero}}
IVA 0% - Operazione non soggetta a IVA ai sensi della legge 190/2014.

{{/if}}
Questo documento non costituisce fattura fiscale, che sar&agrave; emessa al pagamento.
{{/if}}
    </p>

  </footer>

</main>

</body>
</html>
